<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>

    <meta charset="utf-8">
<!-- %meta{:content => "IE=edge,chrome=1", "http-equiv" => "X-UA-Compatible"} -->

<!--Google Apps verification-->

<title>FlashAir Developers - Auto-Refreshing Content List</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta property="fb:admins" content="100006082240886">

<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@FlashAirDev">
<meta property="fb:admins" content="115819238627364">
<meta property="og:site_name" content="FlashAir Developers">
<meta property="og:image" content="https://flashair-developers.com/images/assets/ogp.png">
<meta property="og:url" content="https://flashair-developers.com/en/documents/tutorials/android/5/">
<meta property="og:type" content="article">
<meta property="og:title" content="FlashAir Developers - Auto-Refreshing Content List">

<link href="..\..\..\..\..\images\flashair_favicon.ico" rel="shortcut icon">
<link href="..\..\..\..\..\images\apple-touch-icon-152x152-precomposed.png" rel="apple-touch-icon-precomposed" sizes="152x152">
<link href="..\..\..\..\..\images\apple-touch-icon-120x120-precomposed.png" rel="apple-touch-icon-precomposed" sizes="120x120">
<link href="..\..\..\..\..\images\apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114">
<link href="..\..\..\..\..\images\apple-touch-icon-76x76-precomposed.png" rel="apple-touch-icon-precomposed" sizes="76x76">
<link href="..\..\..\..\..\images\apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72">
<link href="..\..\..\..\..\images\apple-touch-icon-57x57-precomposed.png" rel="apple-touch-icon-precomposed" sizes="57x57">
<!-- Web Fonts -->
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Raleway:300,400,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet">

<!-- Bootstrap core CSS -->
<link href="..\..\..\..\..\css\bootstrap.css" rel="stylesheet">

<!-- Font Awesome CSS -->
<link href="..\..\..\..\..\css\fonts\font-awesome\css\font-awesome.css" rel="stylesheet">

<!-- Plugins -->
<link href="..\..\..\..\..\css\magnific-popup.css" rel="stylesheet">
<link href="..\..\..\..\..\css\settings.css" rel="stylesheet">
<link href="..\..\..\..\..\css\layers.css" rel="stylesheet">
<link href="..\..\..\..\..\css\navigation.css" rel="stylesheet">
<link href="..\..\..\..\..\css\animations.css" rel="stylesheet">
<link href="..\..\..\..\..\css\slick.css" rel="stylesheet">

<!-- The Project's core CSS file -->
<!-- Use css/rtl_style.css for RTL version -->
<link href="..\..\..\..\..\css\style.css" rel="stylesheet">
<!-- The Project's Typography CSS file, includes used fonts -->
<!-- Used font for body: Roboto -->
<!-- Used font for headings: Raleway -->
<!-- Use css/rtl_typography-default.css for RTL version -->
<link href="..\..\..\..\..\css\typography-default.css" rel="stylesheet">
<!-- Color Scheme (In order to change the color scheme, replace the blue.css with the color scheme that you prefer) -->
<link href="..\..\..\..\..\css\light_blue.css" rel="stylesheet">

<!-- Custom css -->
<link href="..\..\..\..\..\css\custom.css" rel="stylesheet">
<link href="..\..\..\..\..\css\prettify.css" rel="stylesheet">
<!--[if lt IE 9]>
	<link href="/css/bootstrap-ie6.css" rel="stylesheet" type="text/css" />
<![endif]-->

    <meta name="keywords" content="FlashAir, Android, app, application, WevDev">
    <meta name="description" content="Tutorials for Android application. FlashAir is a SD card with embedded wireless LAN produced by Toshiba Memory Corp..">
    <meta property="og:description" content="Tutorials for Android application. FlashAir is a SD card with embedded wireless LAN produced by Toshiba Memory Corp..">
</head>

<body class=" ">

    <!-- scrollToTop -->
    <!-- ================ -->
    <div class="scrollToTop circle">
        <i class="fa fa-angle-up"></i>
    </div>

    <!-- page wrapper start -->
    <!-- ================ -->
    <div class="page-wrapper">
        <!-- header-container start -->
        <div class="header-container">
            <!-- header-top start -->
<!-- classes:  -->
<!-- "dark": dark version of header top e.g. class="header-top dark" -->
<!-- "colored": colored version of header top e.g. class="header-top colored" -->
<!-- ================ -->
<div class="header-top dark">
    <div class="container">
        <div class="row">
            <div class="col-6 col-sm-6 col-lg-10">
                <div class="header-top-first clearfix">
                    <ul class="list-inline float-right">
                        <li class="list-inline-item">
                            <a href="..\..\..\..\index.htm" id="go-to-japanese">Japanese</a>&nbsp;&nbsp;&nbsp;/</li>
                        <li class="list-inline-item">
                            English&nbsp;&nbsp;&nbsp;/</li>
                        <li class="list-inline-item">
                            <a href="..\..\..\..\..\zh\index.htm" id="go-to-chinese">Chinese</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-6 col-sm-6 col-lg-2">
                <!-- header-top-second start -->
                <!-- ================ -->
                <div id="header-top-second" class="clearfix">
                    <!-- header top dropdowns start -->
                    <!-- ================ -->
                    <div class="header-top-dropdown text-right">
                        <div class="btn-group">
                            <a href="..\..\..\..\member\index.htm" class="btn btn-default btn-sm">
                                <i class="fa fa-user pr-2"></i> MyAccount</a>
                        </div>
                    </div>
                    <!--  header top dropdowns end -->
                </div>
                <!-- header-top-second end -->
            </div>
        </div>
    </div>
</div>
<!-- header-top end -->
<!-- header start -->
<!-- classes:  -->
<!-- "fixed": enables fixed navigation mode (sticky menu) e.g. class="header fixed clearfix" -->
<!-- "fixed-desktop": enables fixed navigation only for desktop devices e.g. class="header fixed fixed-desktop clearfix" -->
<!-- "fixed-all": enables fixed navigation only for all devices desktop and mobile e.g. class="header fixed fixed-desktop clearfix" -->
<!-- "dark": dark version of header e.g. class="header dark clearfix" -->
<!-- "centered": mandatory class for the centered logo layout -->
<!-- ================ -->
<header class="header fixed fixed-desktop clearfix">
    <div class="container">
        <div class="row">
            <div class="col-md-auto hidden-md-down pl-3">
                <!-- header-first start -->
                <!-- ================ -->
                <div class="header-first clearfix">

                    <!-- logo -->
                    <div id="logo" class="logo">
                        <a href="..\..\..\..\index.htm">
                            <img alt="FlashAir logo" src="..\..\..\..\..\images\assets\flashairLogo_official_small2.png">
                            &nbsp;FlashAir&trade; Developers
                        </a>
                    </div>

                </div>
                <!-- header-first end -->

            </div>
            <div class="col-lg-7 ml-lg-auto">

                <!-- header-second start -->
                <!-- ================ -->
                <div class="header-second clearfix">

                    <!-- main-navigation start -->
                    <!-- classes: -->
                    <!-- "onclick": Makes the dropdowns open on click, this the default bootstrap behavior e.g. class="main-navigation onclick" -->
                    <!-- "animated": Enables animations on dropdowns opening e.g. class="main-navigation animated" -->
                    <!-- ================ -->
                    <div class="main-navigation main-navigation--mega-menu  animated">
                        <nav class="navbar navbar-expand-lg navbar-light p-0">
                            <div class="navbar-brand clearfix hidden-lg-up">

                                <!-- logo -->
                                <div id="logo-mobile" class="logo">
                                    <a href="..\..\..\..\index.htm">
                                        <img alt="FlashAir logo" src="..\..\..\..\..\images\assets\flashairLogo_official_small2.png">
                                        &nbsp;FlashAir&trade; Developers
                                    </a>
                                </div>

                            </div>
                            <!-- header dropdown buttons -->
                            <div class="header-dropdown-buttons hidden-lg-up p-0 ml-auto mr-3">
                                <div class="btn-group">
                                    <button type="button" class="btn dropdown-toggle dropdown-toggle--no-caret" id="header-drop-3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fa fa-search"></i>
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-right dropdown-animation" aria-labelledby="header-drop-3">
                                        <li>
                                            <form role="search" class="search-box margin-clear" id="cse-search-box" action="http://google.com/cse">
                                                <div class="form-group has-feedback">
                                                    <input type="hidden" name="cx" value="015318272157664795635:6mtpckrtgrq">
                                                    <input type="hidden" name="ie" value="UTF-8">
                                                    <input type="text" name="q" size="31" class="form-control">
                                                    <input type="submit" name="sa" value="Search">
                                                </div>
                                            </form>
                                            <script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=ja"></script>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <!-- header dropdown buttons end -->
                            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse-1" aria-controls="navbar-collapse-1" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>

                            <div class="collapse navbar-collapse" id="navbar-collapse-1">
                                <!-- main-menu -->
                                <ul class="navbar-nav ml-xl-auto">
                                    <li class="nav-item dropdown"> <a href="#" class="nav-link dropdown-toggle" id="first-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Discover</a>
                                        <ul class="dropdown-menu" aria-labelledby="first-dropdown">
                                            <li>
                                                <a href="..\..\..\..\discover\overview\index.htm">What's FlashAir?</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\discover\overview\w04\index.htm">Fourth generation FlashAir W-04</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\discover\gettingstarted\index.htm">Getting Started</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\discover\beginners\index.htm">Beginners Guide with FlashAir
                                                    Development</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\discover\usage\index.htm">Get started with FlashAir</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\discover\app\index.htm">Overview of FlashAir Application
                                                    Development</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\discover\device\index.htm">Overview of using Devices with FlashAir</a>
                                            </li>
                                            <li>
                                                <a href="https://iot-hub.flashair-developers.com/en/" target="_blank">FlashAir
                                                    IoT Hub
                                                    <i class="fa fa-external-link"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="nav-item dropdown"> <a href="#" class="nav-link dropdown-toggle" id="second-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Application</a>
                                        <ul class="dropdown-menu" aria-labelledby="second-dropdown">
                                            <li>
                                                <a href="..\..\..\..\application\iot\index.htm">Application to IoT</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\application\devices\index.htm">Using with Devices</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\application\workflow\index.htm">Improve efficiency of operations</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\application\share-documents\index.htm">Sharing Documents</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\application\users\index.htm">User's Projects</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\application\showcase\index.htm">App Showcase</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="nav-item dropdown active"> <a href="#" class="nav-link dropdown-toggle" id="third-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
                                        <ul class="dropdown-menu" aria-labelledby="third-dropdown">
                                            <li class="dropdown ">
                                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Tutorials</a>
                                                <ul class="dropdown-menu to-left">
                                                    <li><a href="..\..\ios\index.htm">iOS</a></li>
                                                    <li><a href="..\index.htm">Android</a></li>
                                                    <li><a href="..\..\web\index.htm">Web browser</a></li>
                                                    <li><a href="..\..\advanced\index.htm">Advanced</a></li>
                                                    <li><a href="..\..\isdio\index.htm">iSDIO</a></li>
                                                    <li><a href="..\..\lua\index.htm">Lua</a></li>
                                                    <li><a href="..\..\users\index.htm">User's Tutorials</a></li>
                                                    <li><a href="..\..\iot-hub\index.htm">FlashAir IoT Hub</a></li>
                                                </ul>
                                            </li>
                                            <li class="dropdown ">
                                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">API Guide</a>
                                                <ul class="dropdown-menu to-left">
                                                    <li><a href="..\..\..\api\commandcgi\index.htm">command.cgi</a></li>
                                                    <li><a href="..\..\..\api\configcgi\index.htm">config.cgi</a></li>
                                                    <li><a href="..\..\..\api\thumbnailcgi\index.htm">thumbnail.cgi</a></li>
                                                    <li><a href="..\..\..\api\uploadcgi\index.htm">upload.cgi</a></li>
                                                    <li><a href="..\..\..\api\config\index.htm">CONFIG</a></li>
                                                    <li><a href="..\..\..\api\utility\index.htm">Browser Utility</a></li>
                                                    <li><a href="..\..\..\api\lua\index.htm">Lua Scripting</a></li>
                                                    <li><a href="..\..\..\api\isdio\index.htm">iSDIO</a></li>
                                                    <li><a href="..\..\..\api\fw40003\index.htm">About FW 4.00.03</a></li>
                                                </ul>
                                            </li>
                                            <li>
                                                <a href="..\..\..\resources\index.htm">Developer Resources</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\books\index.htm">Books</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\about\events\index.htm">Events</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="nav-item dropdown"> <a href="#" class="nav-link dropdown-toggle" id="fourth-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Support</a>
                                        <ul class="dropdown-menu" aria-labelledby="fourth-dropdown">
                                            <li>
                                                <a href="..\..\..\..\support\index.htm">Support</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\support\forum\index.htm">Developer Forum</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\support\faq\index.htm">FAQ</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\support\iot-hub\index.htm">About FlashAir IoT Hub service end</a>
                                            </li>
                                            <li>
                                                <a href="..\..\..\..\support\developers\index.htm">About FlashAir Developers site closure</a>
                                            </li>                
                                        </ul>
                                    </li>
                                </ul>
                                <!-- main-menu end -->
                            </div>
                        </nav>
                    </div>
                    <!-- main-navigation end -->
                </div>
                <!-- header-second end -->

            </div>
            <div class="col-auto hidden-md-down">
                <!-- header dropdown buttons -->
                <div class="header-dropdown-buttons">
                    <div class="btn-group">
                        <button type="button" class="btn dropdown-toggle dropdown-toggle--no-caret" id="header-drop-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-search"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-right dropdown-animation" aria-labelledby="header-drop-3">
                            <li>
                                <form role="search" class="search-box margin-clear" id="cse-search-box" action="http://google.com/cse" target="_blank">
                                    <div class="form-group has-feedback">
                                        <input type="hidden" name="cx" value="015318272157664795635:6mtpckrtgrq">
                                        <input type="hidden" name="ie" value="UTF-8">
                                        <input type="text" name="q" size="31" class="form-control">
                                        <input type="submit" name="sa" value="Search">
                                    </div>
                                </form>
                                <script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=ja"></script>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- header dropdown buttons end -->
            </div>
        </div>
    </div>
    <!-- header end -->
    <!-- Google Analytics Tracking Code -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-498925-24', 'auto');
        ga('send', 'pageview');
    </script>
</header>
        </div>
        <!-- header-container end -->

        <!-- main-container start -->
        <!-- ================ -->
        <section class="main-container">

            <div class="container">
                <div class="row">

                    <!-- main start -->
                    <!-- ================ -->
                    <div class="main col-lg-9 order-lg-2 pb-5">

                        <!-- page-title start -->
                        <!-- ================ -->
                        <h1 class="page-title">
                            Auto-Refreshing Content List</h1>
                        <p class="small text-muted">Latest update: July 2013</p>
                        <!-- page-title end -->

                        <p class="mt-5">
                            <strong>In this tutorial, we will show you how to poll your FlashAir device contents and
                                make your content
                                list auto refresh. We will use
                                <a href="..\..\..\api\thumbnailcgi\index.htm">thumbnail.cgi</a> and
                                <a href="..\..\..\api\commandcgi\index.htm">command.cgi</a> to do this.</strong>
                        </p>

                        <p>We will set the content list we created in
                            <a href="..\4\index.htm">Android Tutorial 4: Getting Image Thumbnails</a>
                            to regularly check if the contents of the FlashAir
                            have changed. If they have changed, the content list will update itself. This tutorial will
                            take
                            some of the commands learned in previous tutorials and use them to obtain or display data.</p>

                        <p>
                            <span class="badge badge-info">Note:</span> To get the most out of this tutorial, we
                            suggest that you insert your FlashAir device
                            into a digital camera. When you take a new photo or delete a photo, this application will
                            show
                            the changed contents of the FlashAir device.</p>

                        <p>The list containing the file name and thumbnail pairs of the contents of your FlashAir
                            device will
                            be formatted like this: </p>

                        <div class="m-3">
                            <img class="img-thumbnail mx-auto d-block" src="..\..\..\..\..\images\tutorials\android_tutorial_05_1.png" alt="This image shows the content list" title="">
                        </div>

                        <p>If you insert your FlashAir device into a digital camera and take a photograph, the content
                            list
                            will refresh itself (after a designated interval of time) and will include the photo that
                            you
                            just took: </p>

                        <div class="m-3">
                            <img class="img-thumbnail mx-auto d-block" src="..\..\..\..\..\images\tutorials\android_tutorial_05_2.png" alt="This image shows an updated content list" title="">
                        </div>

                        <p>You will be able to click the name of the new image file and view the photo in a new screen:
                        </p>

                        <div class="m-3">
                            <img class="img-thumbnail mx-auto d-block" src="..\..\..\..\..\images\tutorials\android_tutorial_05_3.png" alt="This image shows the new image in an image view" title="">
                        </div>

                        <p>As you are viewing the image, the image file will download to your Android device. </p>

                        <p>We will need to create the following files in order to write this application: </p>

                        <ul>
                            <li>
                                <em>MainActivity.java</em>
                            </li>
                            <li>
                                <em>activity_main.xml</em>
                            </li>
                            <li>
                                <em>ImageViewActivity.java</em>
                            </li>
                            <li>
                                <em>activity_image_view.xml</em>
                            </li>
                        </ul>

                        <p>
                            <span class="badge badge-danger">Important:</span> Please note that your project contains a
                            file called
                            <em>AndroidManifest.xml</em>. This file gives your application particular permissions. By
                            default,
                            applications are not permitted to access the internet. The path to this file should look
                            something
                            like:
                            <em>[Project_Folder]/AndroidManifest.xml</em>
                            <br> You will need to add the following lines of code into your
                            <em>AndroidManifest.xml</em> in order for this application to work:</p>

                        <pre class="prettyprint linenums"><code>&lt;uses-permission android:name="android.permission.INTERNET" /&gt;
</code></pre>

                        <h2>
                            Creating the List Layout
                        </h2>
                        <div class="separator-2"></div>

                        <p>First, we will write the
                            <em>activity_main.xml</em> file that determines the layout of our Android App. This can be
                            found
                            in your layout folder. The path to this file should look something like:
                            <em>[Project_Folder]/res/layout/activity_main.xml</em>
                        </p>

                        <p>This file will be identical to the
                            <em>activity_main.xml</em> file from
                            <a href="..\3\index.htm">Android Tutorial 3: Downloading Content</a>.
                            Please refer to that tutorial for an explanation
                            of the implementation. </p>

                        <h2>
                            Creating the Image Viewing Layout
                        </h2>
                        <div class="separator-2"></div>

                        <p>Next, we will create the
                            <em>activity_image_view.xml</em> file that determines the layout of our image viewing
                            screen. This
                            can also be found in your layout folder. The path to this file should look something like:
                            <em>[Project_Folder]/res/layout/activity_image_view.xml</em>
                        </p>

                        <p>This file will be identical to the
                            <em>activity_image_view.xml</em> file from
                            <a href="..\3\index.htm">Android Tutorial 3: Downloading Content</a>.
                            Please refer to that tutorial for an explanation
                            of the implementation. </p>

                        <h2>
                            Creating the Content List
                        </h2>
                        <div class="separator-2"></div>

                        <p>First, we will get a list of the file names in the desired directory of your FlashAir device
                            (see
                            <a href="..\3\index.htm">Android Tutorial 3: Downloading Content</a>
                            for a detailed explanation). </p>

                        <p>Then we will set each file name in the list to an associated thumbnail, display both the
                            file name
                            and thumbnail pair in a
                            <code>ListView</code> format, and set the behavior of the list. For detailed explanation on
                            the implementation,
                            see
                            <a href="..\4\index.htm">Android Tutorial 4: Getting Image Thumbnails</a>
                        </p>

                        <h3>
                            Initialization
                        </h3>

                        <p>Please take the
                            <em>MainActivity.java</em> code from
                            <a href="..\4\index.htm">Android Tutorial 4: Getting Image Thumbnails</a>
                            and copy it into your new
                            <em>MainActivity.java</em> file. </p>

                        <p>We will replace the
                            <code>class MainActivity</code> declaration, member variables, and
                            <code>onCreate(Bundle savedInstanceState)</code> function with the code below:</p>

                        <h4>
                            <em>MainActivity.java</em> (1)</h4>

                        <pre class="prettyprint linenums"><code>public class MainActivity extends Activity implements AdapterView.OnItemClickListener {

    ListView listView;
    ImageView imageView;
    TextView currentDirText;
    TextView numFilesText;
    Button backButton;
    String rootDir = "DCIM";
    String directoryName = rootDir; // Initialize to rootDirectory
    SimpleAdapter listAdapter;
    int checkInterval = 5000;
    Handler updateHandler;
    boolean viewingList;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        viewingList = true; // Start out viewing the list
        try {
            // Set buttons
            getWindow().setTitleColor(Color.rgb(65, 183, 216));
            backButton = (Button)findViewById(R.id.button1);
            backButton.getBackground().setColorFilter(Color.rgb(65, 183, 216), PorterDuff.Mode.SRC_IN);
            backButton.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    if(directoryName.equals(rootDir)) {
                        listRootDirectory();
                    }
                    else {
                        int index = directoryName.lastIndexOf("/");
                        directoryName = directoryName.substring(0, index);
                        listDirectory(directoryName);
                    }
                }
            });
            backButton.setEnabled(false); // Disable in root directory
            listRootDirectory();
        } catch(Exception e) {
            Log.e("ERROR", "ERROR: " + e.toString());
            e.printStackTrace();
        }
        updateHandler = new Handler();
        startUpdate();
    }
</code></pre>

                        <p>We have added a few new member variables to our previous
                            <code>MainActivity</code> class. </p>

                        <ul>
                            <li>Line 11:
                                <br> We declare
                                <code>int checkInterval</code>, which will set the interval of time (in milliseconds)
                                between status
                                checks of the FlashAir.</li>
                            <li>Line 12:
                                <br> We declare
                                <code>Handler updateHandler</code>, which will manage the
                                <code>Runnable</code> that we will implement in the functions below.</li>
                            <li>Line 13:
                                <br> We declare
                                <code>boolean viewingList</code>, which will track whether the user is currently
                                viewing a content
                                list or an image.</li>
                        </ul>

                        <p>It is worth noting that we have set the root directory to be the "DCIM" folder (line 8). You
                            do not
                            have to set this as your root directory. Since the "DCIM" folder is the location that most
                            digital
                            cameras store photos, it is set as the root directory for this tutorial. </p>

                        <p>We will leave the rest of the code in
                            <em>MainActivity.java</em> as is. (This should include the functions to set up the content
                            list.)</p>

                        <h3>
                            Determining the User's Current View
                        </h3>

                        <p>We will add the code that handles status checking and updating to the
                            <em>MainActivity.java</em> file. This code should be included inside
                            <code>class MainActivity</code> with the other functions we have previously written. </p>

                        <p>If the user is not currently viewing a content list, there is no need to poll the FlashAir
                            device
                            - the content list will get the most current updates when it loads. However, if the user is
                            currently
                            viewing a content list, we will poll the contents of the FlashAir regularly and display any
                            changes.
                        </p>

                        <p>In order to determine whether the user is viewing a list, we will override a listener
                            function to
                            update the value of the flag variable
                            <code>viewingList</code> declared above (on line 13).</p>

                        <h4>
                            <em>MainActivity.java</em> (2)</h4>

                        <pre class="prettyprint linenums"><code>    @Override
        public void onWindowFocusChanged(boolean hasFocus) {
            super.onWindowFocusChanged(hasFocus);
            if(hasFocus) {
                viewingList = true;
            }
            else {
                viewingList = false;
            }
        }


    public boolean checkIfListView() {
        // Check if user is viewing a content list
        if(viewingList) {
            return true;
        }
        return false;
    }
</code></pre>

                        <p>The variable flag
                            <code>hasFocus</code> will be true if the screen showing the content list is currently
                            being displayed
                            to the user. Each time the user changes their
                            <code>View</code>, the app will be informed. This will facilitate setting the behavior of
                            the
                            <code>Runnable</code> below.</p>

                        <h3>
                            Setting Up the Update Handler &amp; Content Refresh Task
                        </h3>

                        <p>We will use the following CGI command to get the update status of the FlashAir:</p>

                        <ul>
                            <li>
                                <code>command.cgi</code> with
                                <code>op=102</code>
                                <ul>
                                    <li>
                                        The command will look like this:
                                        <code>http://flashair/command.cgi?op=102</code>
                                    </li>
                                    <li>
                                        The command will return the following data:
                                        <ul>
                                            <li>
                                                <code>1</code> if the FlashAir memory has been updated
                                            </li>
                                            <li>
                                                <code>0</code> if the memory has not been updated
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>

                        <p>The CGI command that gets the update status of your FlashAir will only return
                            <code>1</code> once. Any future queries before another change is made will return
                            <code>0</code>, as the FlashAir memory has not been updated since the last query. </p>

                        <p>To execute this CGI command, we will reuse the
                            <em>FlashAirRequest.java</em> file from
                            <a href="..\3\index.htm">Android Tutorial 3: Downloading Content</a>:
                        </p>

                        <p>The following functions determine the behavior and frequency for auto refreshing the content
                            list.</p>

                        <h4>
                            <em>MainActivity.java</em> (3)</h4>

                        <pre class="prettyprint linenums"><code>    public Runnable statusChecker = new Runnable() {
        @Override
        public void run() {
            if (checkIfListView() == true) {
                new AsyncTask&lt;String, Void, String&gt;(){
                    @Override
                    protected String doInBackground(String... params) {
                        return FlashAirRequest.getString(params[0]);
                    }
                    @Override
                    protected void onPostExecute(String status) {
                        if(status.equals("1")) {
                            // Fetch current contents of FlashAir and display list
                            listDirectory(directoryName);
                        }
                    }
                }.execute("http://flashair/command.cgi?op=102");
            }
            updateHandler.postDelayed(statusChecker, checkInterval);
        }
    };


    public void startUpdate() {
        statusChecker.run();    
    }


    public void stopUpdate() {
        updateHandler.removeCallbacks(statusChecker);
    }
</code></pre>

                        <ul>
                            <li>Lines 3-20:
                                <br> We set the
                                <code>run()</code> function, which sets the main behavior of the
                                <code>Runnable class</code>.</li>
                            <li>Line 19:
                                <br> We have the
                                <code>updateHandler</code> assign the
                                <code>statusChecker</code> to perform its
                                <code>run()</code> function in
                                <code>checkInterval</code> milliseconds. Note that this code is executed inside the
                                <code>run()</code> function itself. This means that so long as the
                                <code>updateHandler</code> does not stop running, each time the
                                <code>statusChecker</code> performs its
                                <code>run()</code> function, it is assigned to run again in
                                <code>checkInterval</code> milliseconds.</li>
                        </ul>

                        <h2>
                            Creating the Image Viewing Screen
                        </h2>
                        <div class="separator-2"></div>

                        <p>This file will be identical to the
                            <code>class ImageViewActivity</code> from
                            <a href="..\3\index.htm">Android Tutorial 3: Downloading Content</a>.
                            Please refer to that tutorial for an explanation
                            of the implementation. </p>

                        <h2>
                            Sample Code
                        </h2>
                        <div class="separator-2"></div>

                        <p>
                            <a class="btn btn-primary" href="..\..\..\..\..\files\samplecode\android\android_tutorial_05.zip" onclick="_gaq.push(['_trackEvent', 'Sample Code Download', 'android_tutorial_05.zip', 'en', true]);">
                                <i class="fa fa-download pr-10"></i> android_tutorial_05.zip</a> (533KB)</p>

                        <p>
                            <p class="small">All sample code on this page is licensed under
                                <a href="..\..\..\license\index.htm" target="_blank">BSD 2-Clause License</a>
                            </p>
                        

                        <!-- Social Buttons -->
                        <div class="clearfix">
	<ul class="social-links float-right">
		<li class="twitter">
			<!--Tweet Button-->
			<a href="https://twitter.com/share" class="twitter-share-button" {count}="" data-via="FlashAirDev" data-related="FlashAirDev">Tweet</a>
			<script>
				! function (d, s, id) {
					var js, fjs = d.getElementsByTagName(s)[0],
						p = /^http:/.test(d.location) ? 'http' : 'https';
					if (!d.getElementById(id)) {
						js = d.createElement(s);
						js.id = id;
						js.src = p + '://platform.twitter.com/widgets.js';
						fjs.parentNode.insertBefore(js, fjs);
					}
				}(document, 'script', 'twitter-wjs');
			</script>
		</li>
		<li class="facebook">
			<!--Facebook Like Button-->
			<div id="fb-root"></div>
			<script>
				(function (d, s, id) {
					var js, fjs = d.getElementsByTagName(s)[0];
					if (d.getElementById(id)) return;
					js = d.createElement(s);
					js.id = id;
					js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
					fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'facebook-jssdk'));
			</script>
			<div class="fb-like" data-href="https://www.flashair-developers.com/" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="verdana"></div>
		</li>		
	</ul>
</div>

                        <!-- pagination start -->
                        <nav aria-label="Page navigation">
                            <ul class="pagination justify-content-between">
                                <li>
                                    <a class="btn radius-50 page-link badge-pill" href="..\4\index.htm" aria-label="Previous">
                                        <i class="fa fa-chevron-left pr-10"></i>
                                        Displaying Image Thumbnails
                                    </a>
                                </li>
                                <li>
                                    <a class="btn radius-50 page-link badge-pill" href="..\6\index.htm" aria-label="Next">
                                        Changing SSID and Network Password
                                        <i class="fa fa-chevron-right pl-10"></i>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                        <!-- pagination end -->

                        <!-- Amazon bottom link -->
                        <div class="col-12">
	<!--Amazon search result for tablet-->
	<div class="amazon-widget-bottom mx-auto d-none d-md-block d-lg-none">
		<!--
<iframe src="http://rcm.amazon.com/e/cm?t=flasdeve-20&o=1&p=12&l=st1&mode=photo&search=toshiba%20flashair&fc1=333333&lt1=_blank&lc1=009BDD&bg1=FFFFFF&f=ifr" marginwidth="0" marginheight="0" width="300" height="250" border="0" frameborder="0" style="border:none;" scrolling="no"></iframe>
-->
		<div class="amazon-content" marginwidth="0" marginheight="0" width="320" height="250" border="0" frameborder="0" style="border: none;" scrolling="no"></div>
	</div>

	<!--Amazon search result for smartphone-->
	<div class="amazon-widget-mobile mx-auto d-md-none">
		<!--Image-->
		<!--
	<a href="http://www.amazon.com/gp/product/B009RGP7HY/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=B009RGP7HY&linkCode=as2&tag=flasdeve-20" alt="TOSHIBA FlashAir SD card 8GB SD-WB008G"><img src="http://ws.assoc-amazon.com/widgets/q?_encoding=UTF8&ASIN=B009RGP7HY&Format=_SL110_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=flasdeve-20" style="vertical-align:middle;"/></a><br>
-->
		<!--Text-->
		<!--
<a href="http://www.amazon.com/gp/product/B009RGP7HY/ref=as_li_tf_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B009RGP7HY&linkCode=as2&tag=flasdeve-20">Find TOSHIBA FlashAir SD card 8GB SD-WB008G on Amazon.com</a><img src="http://www.assoc-amazon.com/e/ir?t=flasdeve-20&l=as2&o=1&a=B009RGP7HY" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
-->
		<div class="amazon-content" marginwidth="0" marginheight="0" border="0" frameborder="0" style="border: none;" scrolling="no"></div>
	</div>
</div>

                    </div>
                    <!-- main end -->

                    <!-- sidebar start -->
                    <!-- ================ -->
                    <aside class="col-lg-3 col-xl-3 order-lg-1">
                        <div class="sidebar">
  <div class="block clearfix">
    <nav>
      <ul class="nav flex-column">
        <li class="nav-item"> <a class="nav-link" href="..\1\index.htm">
          Overview of FlashAir App Development for Android
          </a>
        </li>

        <li class="nav-item"> <a class="nav-link" href="..\2\index.htm">
          Getting A List of Contents
          </a>
        </li>

        <li class="nav-item"> <a class="nav-link" href="..\3\index.htm">
          Downloading Content
          </a>
        </li>

        <li class="nav-item"> <a class="nav-link" href="..\4\index.htm">
          Displaying Image Thumbnails
          </a>
        </li>

        <li class="nav-item active"> <a class="nav-link active" href="index.htm">
          Auto-Refreshing Content List
          </a>
        </li>

        <li class="nav-item"> <a class="nav-link" href="..\6\index.htm">
          Changing SSID and Network Password
          </a>
        </li>

        <li class="nav-item"> <a class="nav-link" href="..\7\index.htm">
          Uploading to FlashAir
          </a>
        </li>

        <li class="nav-item"> <a class="nav-link" href="..\8\index.htm">
          Photo Share
          </a>
        </li>
        <li>
          <br>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="..\index.htm">
            Back to Content List
          </a>
        </li>
      </ul>
    </nav>
  </div>
  <p>
    <a href="..\index.htm">
      <img alt="flashair android" src="..\..\..\..\..\images\assets\flashair-android-side.png">
    </a>
  </p>

  <!-- Amazon side link -->
  <!--Amazon search result for desktop-->
<div class="amazon-widget-side d-none d-lg-block">
	<!--
	<iframe src="http://rcm.amazon.com/e/cm?t=flasdeve-20&o=1&p=14&l=st1&mode=photo&search=toshiba%20flashair&fc1=333333&lt1=_blank&lc1=009BDD&bg1=FFFFFF&f=ifr" marginwidth="0" marginheight="0" width="160" height="600" border="0" frameborder="0" style="border: medium none; float: right; font-size: 14px;" scrolling="no"></iframe>
	-->
	<div class="amazon-content" marginwidth="0" marginheight="0" width="160" height="600" border="0" frameborder="0" style="border: medium none; float: right; font-size: 14px;" scrolling="no"></div>
</div>
                    </div></aside>
                    <!-- sidebar end -->

                </div>
            </div>
        </section>
        <!-- main-container end -->

        <!-- footer start -->
        <!-- ================ -->
        <!-- footer start -->
<!-- ================ -->
<footer id="footer" class="clearfix ">

  <!-- .footer start -->
  <!-- ================ -->
  <div class="footer">
    <div class="container">
      <div class="footer-inner">
        <div class="row">
          <div class="col-lg-4">
            <div class="footer-content">
              <h2 class="title">
                <img alt="FlashAir logo" src="..\..\..\..\..\images\assets\flashairLogo_official_small2.png"> FlashAir&trade; Developers</h2>
              <div class="separator-2"></div>
              <p>
                  A technical information website for developers of Toshiba FlashAir apps or services. FlashAir Developers is operated by Fixstars in cooperation with Toshiba Memory Corporation. To learn more about Fixstars, visit
                <a target="_blank" href="http://www.fixstars.com">www.fixstars.com
                  <i class="fa fa-external-link"></i>
                </a>. ?FlashAir is a trademark of Toshiba Memory Corporation.
              </p>
              <ul class="social-links circle animated-effect-1" style="margin-bottom: 10px">
                <li class="facebook">
                  <a href="https://www.facebook.com/FlashAir-Developers-115819238627364/" target="_blank">
                    <i class="fa fa-facebook"></i>
                  </a>
                </li>
                <li class="twitter">
                  <a href="https://twitter.com/FlashAirDev/" target="_blank">
                    <i class="fa fa-twitter"></i>
                  </a>
                </li>
              </ul>
              <ul class="list-unstyled list-inline m-0">
                <li class="list-inline-item"><a href="..\..\..\..\terms-of-use\index.htm">Terms of Use</a></li>
                <li class="list-inline-item">|</li>
                <li class="list-inline-item"><a href="..\..\..\..\privacypolicy\index.htm">Privacy Policy</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer-content">
              <h2 class="title">Twitter</h2>
              <div class="separator-2"></div>
              <div id="twitterWidget">
                <a class="twitter-timeline" data-theme="light" href="https://twitter.com/FlashAirDev" data-widget-id="344743426811641856" height="230" data-chrome="nofooter noheader noborders transparent">Latest News</a>
                <script>
                  ! function (d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0],
                      p = /^http:/.test(d.location) ? 'http' : 'https';
                    if (!d.getElementById(id)) {
                      js = d.createElement(s);
                      js.id = id;
                      js.src = p + "://platform.twitter.com/widgets.js";
                      fjs.parentNode.insertBefore(js, fjs);
                    }
                  }(document, "script", "twitter-wjs");
                </script>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer-content">
              <h2 class="title">Sitemap</h2>
              <div class="separator-2"></div>
              <nav>
                <ul class="nav flex-column">
                  <li class="nav-item">
                    <a class="nav-link" href="..\..\..\..\discover\overview\index.htm">What's FlashAir?
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="..\..\..\resources\index.htm">Developer Resources
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="..\..\index.htm">Tutorials
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="..\..\..\api\index.htm">API Guide
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="..\..\..\..\support\index.htm">Support
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="..\..\..\..\support\forum\index.htm">Developer Forum
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="https://iot-hub.flashair-developers.com/en/" target="_blank">FlashAir IoTHub <i class="fa fa-external-link"></i>
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- .footer end -->

  <!-- .subfooter start -->
  <!-- ================ -->
  <div class="subfooter">
    <div class="container">
      <div class="subfooter-inner">
        <div class="row">
          <div class="col-md-12">
            <p class="text-center">Copyright &copy; 2019 FlashAir Developers. All rights reserved.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- .subfooter end -->

  <div id="overlay">
    <div class="container">
      <div class="row">
        <div class="col-md-10 ml-auto text-white">
          <p class="mt-3">If you write software or change the settings which are described on this site to your FlashAir device which was purchased at a mass retailer or online shop, it will not be eligible for a free replacement under the warranty policy. Please acknowledge and carry out development at your own risk.
          </p>
        </div>
        <div class="col-md-2 row">
          <div class="align-self-center">
          <button class="btn btn-default" id="btn-agree">Accept</button>
        </div>
        </div>
      </div>
    </div>
  </div>

</footer>
<!-- footer end -->

<!-- JavaScript files placed at the end of the document so the pages load faster -->
<!-- ================================================== -->
<!-- Jquery and Bootstap core js files -->
<script src="..\..\..\..\..\js\jquery.min.js"></script>
<script src="..\..\..\..\..\js\bootstrap.bundle.min.js"></script>
<!-- jQuery Revolution Slider  -->
<script src="..\..\..\..\..\js\jquery.themepunch.tools.min.js"></script>
<script src="..\..\..\..\..\js\jquery.themepunch.revolution.min.js imagesloaded.pkgd.min.js.pagespeed.jc.cG4Ou2l09T.js"></script><script>eval(mod_pagespeed_faLzhRoycV);</script>
<!-- Isotope javascript -->
<script>eval(mod_pagespeed_e7p3yiKri5);</script>
<script src="..\..\..\..\..\js\isotope.pkgd.min.js jquery.magnific-popup.min.js jquery.waypoints.min.js sticky.min.js jquery.countTo.js.pagespeed.jc.cWqBgip635.js"></script><script>eval(mod_pagespeed_EzjKnImtZK);</script>
<!-- Magnific Popup javascript -->
<script>eval(mod_pagespeed_hr4XVzGccf);</script>
<!-- Appear javascript -->
<script>eval(mod_pagespeed_zhicDWZgIJ);</script>
<script>eval(mod_pagespeed_MTpYywWOfL);</script>
<!-- Count To javascript -->
<script>eval(mod_pagespeed_dmh3ejQ5o0);</script>
<!-- Slick carousel javascript -->
<script src="..\..\..\..\..\js\slick.min.js pace.min.js template.js jquery.cookie.js custom.js jquery.matchHeight.js.pagespeed.jc.Y3630FlbPX.js"></script><script>eval(mod_pagespeed_s1mKdTeuWx);</script>
<!-- Pace javascript -->
<script>eval(mod_pagespeed_Zs67JgCVyk);</script>
<!-- Initialization of Plugins -->
<script>eval(mod_pagespeed_BIPkzwMbEw);</script>
<!-- Custom Scripts -->
<script>eval(mod_pagespeed_uSq_SD1Gz5);</script>
<script>eval(mod_pagespeed_mqKjjurRp4);</script>
<script>eval(mod_pagespeed_TteNs$c3Zl);</script>
<script>
  $(function () {
    $('.matchHeight').matchHeight();
  });
</script>
<script src="..\..\..\..\..\js\script.js prettify.js lang-lua.js lang-css.js.pagespeed.jc.ECF3Z77mjV.js"></script><script>eval(mod_pagespeed_SrZ0Yqg7MZ);</script>
<script>eval(mod_pagespeed_RSPiDhly$4);</script>
<script>eval(mod_pagespeed_0pGoVUEAt9);</script>
<script>eval(mod_pagespeed_IrbA2eGHA$);</script>
<script>
  ! function ($) {
    $(function () {
      PR.prettyPrint()
    })
  }(window.jQuery)
</script>
        <!-- footer end -->
    </div>
    <!-- page wrapper end -->
</body>

</html>