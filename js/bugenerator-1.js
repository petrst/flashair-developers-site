var buGeneratorURL="bugenerator/";var buGeneratorTempURL="bugenerator/";var buKey="";var buData;var buTemplateStyleType="";var buLangResource={'ja':{'button-style-important':'重要','msg-key-failure':'インターネット接続が確認できません。本ツールにはインターネット接続が必要です。','msg-download-failure':'ダウンロード出来ませんでした。プレビュー表示を閉じてからやり直してください。'},'en':{'button-style-important':'Important','msg-key-failure':'No Internet connection found. Enable Internet connection to use this tool.','msg-download-failure':'Download failed. Please close preview window and retry.'},'zh':{'button-style-important':'Important','msg-key-failure':'No Internet connection found. Enable Internet connection to use this tool.','msg-download-failure':'Download failed. Please close preview window and retry.'}};var buLang='en';(function(){if($('html').attr('lang')==='ja'){buLang='ja';}else if($('html').attr('lang')==='zh'){buLang='zh';}buGeneratorURL='/'+buLang+'/'+buGeneratorURL
buGeneratorTempURL='/'+buLang+'/'+buGeneratorTempURL
$('.bu-generator .bu-button .bu-button-remove').each(function(){$(this).on('click',buRemoveButton);});$('.bu-generator .bu-button .bu-button-add').each(function(){$(this).on('click',buAddButton);});$('#preview-button').on('click',function(event){$('#preview-image').hide();$('#preview-image').attr('src','/images/assets/loader.gif');$('#loader').show();$('#download-button').attr('disabled',true);requestBUGeneratorHtml(function(response){$('#preview-image').attr('src','/files/bugenerator/'+buKey+'/'+response['screenshot']);$('#preview-image').show();$('#loader').hide();$('#download-button').attr('disabled',false);$('#download-button').removeAttr('disabled');},function(request,status,error){$('#preview-image').attr('src','/images/assets/proceedings-template.png');$('#preview-image').show();$('#loader').hide();});event.preventDefault();});$('#download-button').on('click',function(event){location.href='/files/bugenerator/'+buKey+'/YourBrowserUtility.zip';event.preventDefault();});$('#reset-button').on('click',function(event){$('body').scrollTop(0);resetContents();event.preventDefault();});$('#logo-upload').on('change',function(event){$('#logo-upload-button-information').show();});$('#logo-upload-button').on('click',function(event){requestBUGeneratorUploadLogo(function(response){$('#logo-current').attr('src',response['path']);$('#logo-upload-button-information').hide();},function(request,status,error){alert(buLangResource[buLang]['msg-upload-failure']);});event.preventDefault();});$('.bu-generator .bu-template-style div.control-group div').each(function(){$(this).click(function(){var radioButton=$(this).find('input[type="radio"]');buTemplateStyleType=radioButton.val();$(this).siblings('div').each(function(){$(this).removeClass('active');});$(this).addClass('active');radioButton.prop('checked',true);});});$('.bu-generator .bu-template-style .control-group input[type="radio"]').each(function(){$(this).click(function(){$(this).closest('div');});if($(this).attr('checked')==='checked'){buTemplateStyleType=$(this).val();}});resetContents();requestBUGeneratorKey(function(response){buKey=response['key'];},function(request,status,error){alert(buLangResource[buLang]['msg-key-failure']);});})();function buAddButton(event){var buttons=$('.bu-generator .bu-button');if(buttons.length<6){var thisButton=$(event.target).parents('.bu-button');var button_template=$('.bu-generator .bu-button-template');var newButton=$(button_template).clone();newButton.removeClass('bu-button-template d-none');newButton.addClass('bu-button');newButton.find('.bu-button-remove').on('click',buRemoveButton);newButton.find('.bu-button-add').on('click',buAddButton);$(thisButton[0]).after(newButton);newButton.show('fast');}}function buRemoveButton(event){var buttons=$('.bu-generator .bu-button');if(buttons.length>1){var thisButton=$(event.target).parents('.bu-button');$(thisButton[0]).fadeOut('fast',function(){$(this).remove();});}}function resetContents(){$('#optionsRadios1').click();$('#logo-upload').val('');$('#logo-current').attr('src','/images/assets/FlashAir-logo.png');$('#bu-title-text').val('On-Site Document Download Service');$('.bu-button').each(function(){$(this).remove();});var buttonTemplate=$('.bu-generator .bu-button-template');for(var i=0;i<5;i++){var newButton=$(buttonTemplate).clone();newButton.removeClass('bu-button-template d-none').addClass('bu-button');newButton.find('.bu-button-remove').on('click',buRemoveButton);newButton.find('.bu-button-add').on('click',buAddButton);$(buttonTemplate).after(newButton);newButton.show();}}function makeDataAsJson(){var logofile='';var logoFileList=$('#logo-upload').prop('files');if(logoFileList.length>0){logofile=logoFileList[0].name;}buData={'template':{'style':buTemplateStyleType},'logo':{'source':logofile,'text':'logo','link':''},'lang':buLang,'title':{'text':$('.bu-generator #bu-title-text').val(),'text-color':'#CCCCCC','text-size':'16','link':''},'contents':{'buttons':[]}};$('.bu-generator .bu-button').each(function(){var buttonData=new Object;if($(this).find('.bu-button-style').val()===buLangResource[buLang]['button-style-important']){buttonData['style']='important';}else{buttonData['style']='standard';}buttonData['text']=$(this).find('.bu-button-text').val();buttonData['text-size']=$(this).find('.bu-button-text-size').val();buttonData['link']=$(this).find('.bu-button-link').val();buData['contents']['buttons'].push(buttonData);});}function requestBUGeneratorKey(onSuccess,onError){var request={'request':{'command':'generateKey'}};$.ajax({type:'POST',url:buGeneratorURL,data:request,dataType:'json',success:function(response){onSuccess(response);},error:function(request,status,error){onSuccess(request,status,error);},});}function requestBUGeneratorHtml(onSuccess,onError){makeDataAsJson();var request={'request':{'command':'generateHtml','key':buKey,'data':buData}};$.ajax({type:'POST',url:buGeneratorURL,data:request,dataType:'json',success:function(response){onSuccess(response);},error:function(request,status,error){onError(request,status,error);},});}function requestBUGeneratorUploadLogo(onSuccess,onError){var json={'request':{'command':'uploadLogo','key':buKey,}};var form=$('#logo-form');var fd=new FormData(form[0]);fd.append('request',JSON.stringify(json));$.ajax({type:'POST',url:buGeneratorURL,data:fd,dataType:'json',contentType:false,processData:false,success:function(response){onSuccess(response);},error:function(request,status,error){onSuccess(request,status,error);},});}